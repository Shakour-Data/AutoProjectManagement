# AutoProjectManagement Monitoring Configuration
# Production Monitoring and Alerting Setup

version: '1.0'
description: Production monitoring configuration for AutoProjectManagement

## Prometheus Configuration
prometheus:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    environment: production
    application: autoprojectmanagement

  scrape_configs:
    - job_name: 'autoprojectmanagement'
      static_configs:
        - targets: ['localhost:8000']
          labels:
            instance: 'autoprojectmanagement-app'
            service: 'web-application'

    - job_name: 'node-exporter'
      static_configs:
        - targets: ['localhost:9100']
          labels:
            instance: 'server-monitoring'
            service: 'system-metrics'

    - job_name: 'postgres-exporter'
      static_configs:
        - targets: ['localhost:9187']
          labels:
            instance: 'database-monitoring'
            service: 'postgres-metrics'

## Alertmanager Configuration
alertmanager:
  global:
    resolve_timeout: 5m
    smtp_smarthost: 'smtp.gmail.com:587'
    smtp_from: 'alerts@autoprojectmanagement.com'
    smtp_auth_username: 'alert-user'
    smtp_auth_password: '${SMTP_PASSWORD}'

  route:
    group_by: ['alertname', 'environment']
    group_wait: 30s
    group_interval: 5m
    repeat_interval: 3h
    receiver: 'slack-notifications'

    routes:
      - match:
          severity: critical
        receiver: 'pagerduty-critical'
        repeat_interval: 30m

      - match:
          severity: warning
        receiver: 'email-notifications'

  receivers:
    - name: 'slack-notifications'
      slack_configs:
        - api_url: '${SLACK_WEBHOOK_URL}'
          channel: '#alerts'
          send_resolved: true
          title: '{{ .CommonAnnotations.summary }}'
          text: |-
            {{ range .Alerts }}
